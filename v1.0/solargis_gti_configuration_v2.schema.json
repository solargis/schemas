{
  "$id": "https://raw.githubusercontent.com/solargis/schemas/main/v1.0/solargis_gti_configuration_v2.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema",
  "description": "Base schema for a Solargis GTI system definition for simulation request - not used in public APIs.",
  "allOf": [
    {
      "$ref": "#/$defs/GtiSystem"
    }
  ],
  "$defs": {
    "MonthDay": {
      "type": "string",
      "pattern": "^\\d{2}-\\d{2}$"
    },
    "GtiDegreesMountingTilt": {
      "type": "number",
      "minimum": 0,
      "maximum": 90
    },
    "GtiMonthlyValuesDegreesMountingTilt": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/GtiDegreesMountingTilt"
      },
      "minItems": 12,
      "maxItems": 12
    },
    "GtiSeasonalDegreesMountingTilt": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "dateOfChange": {
            "$ref": "#/$defs/MonthDay"
          },
          "tilt": {
            "$ref": "#/$defs/GtiDegreesMountingTilt"
          }
        },
        "required": [
          "dateOfChange",
          "tilt"
        ]
      }
    },
    "GtiDegreesRotationLimitEastHorizontalInclinedTracker": {
      "type": "number",
      "minimum": -90,
      "maximum": 90
    },
    "GtiDegreesRotationLimitWestHorizontalInclinedTracker": {
      "type": "number",
      "minimum": -90,
      "maximum": 90
    },
    "GtiDegreesRotationLimitEastVerticalTwoAxisTracker": {
      "type": "number",
      "minimum": -180,
      "maximum": 180
    },
    "GtiDegreesRotationLimitWestVerticalTwoAxisTracker": {
      "type": "number",
      "minimum": -180,
      "maximum": 180
    },
    "GtiMountingFixedOneAngle": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "FIXED_ONE_ANGLE"
          ]
        },
        "tilt": {
          "oneOf": [
            {
              "$ref": "#/$defs/GtiDegreesMountingTilt"
            },
            {
              "$ref": "#/$defs/GtiMonthlyValuesDegreesMountingTilt"
            },
            {
              "$ref": "#/$defs/GtiSeasonalDegreesMountingTilt"
            }
          ]
        }
      },
      "required": [
        "type",
        "tilt"
      ],
      "additionalProperties": false
    },
    "GtiMountingOneAxisHorizontalTrackerNS": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "ONE_AXIS_HORIZONTAL_TRACKER_NS"
          ]
        },
        "backtracking": {
          "type": "boolean"
        },
        "rotationLimitEast": {
          "$ref": "#/$defs/GtiDegreesRotationLimitEastHorizontalInclinedTracker"
        },
        "rotationLimitWest": {
          "$ref": "#/$defs/GtiDegreesRotationLimitWestHorizontalInclinedTracker"
        }
      },
      "required": [
        "type",
        "backtracking",
        "rotationLimitEast",
        "rotationLimitWest"
      ],
      "additionalProperties": false
    },
    "GtiMountingOneAxisInclinedTrackerNS": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "ONE_AXIS_INCLINED_TRACKER_NS"
          ]
        },
        "axisTilt": {
          "$ref": "#/$defs/GtiDegreesMountingTilt"
        },
        "backtracking": {
          "type": "boolean"
        },
        "rotationLimitEast": {
          "$ref": "#/$defs/GtiDegreesRotationLimitEastHorizontalInclinedTracker"
        },
        "rotationLimitWest": {
          "$ref": "#/$defs/GtiDegreesRotationLimitWestHorizontalInclinedTracker"
        }
      },
      "required": [
        "axisTilt",
        "type",
        "backtracking",
        "rotationLimitEast",
        "rotationLimitWest"
      ],
      "additionalProperties": false
    },
    "GtiMountingOneAxisVerticalTracker": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "ONE_AXIS_VERTICAL_TRACKER"
          ]
        },
        "tilt": {
          "$ref": "#/$defs/GtiDegreesMountingTilt"
        },
        "rotationLimitEast": {
          "$ref": "#/$defs/GtiDegreesRotationLimitEastVerticalTwoAxisTracker"
        },
        "rotationLimitWest": {
          "$ref": "#/$defs/GtiDegreesRotationLimitWestVerticalTwoAxisTracker"
        }
      },
      "required": [
        "type",
        "tilt",
        "rotationLimitEast",
        "rotationLimitWest"
      ],
      "additionalProperties": false
    },
    "GtiMountingTwoAxisAstronomicalTracker": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "TWO_AXIS_ASTRONOMICAL_TRACKER"
          ]
        },
        "tiltLimitMin": {
          "$ref": "#/$defs/GtiDegreesMountingTilt"
        },
        "tiltLimitMax": {
          "$ref": "#/$defs/GtiDegreesMountingTilt"
        },
        "rotationLimitEast": {
          "$ref": "#/$defs/GtiDegreesRotationLimitEastVerticalTwoAxisTracker"
        },
        "rotationLimitWest": {
          "$ref": "#/$defs/GtiDegreesRotationLimitWestVerticalTwoAxisTracker"
        },
        "backtracking": {
          "type": "boolean"
        }
      },
      "required": [
        "type",
        "tiltLimitMin",
        "tiltLimitMax",
        "rotationLimitEast",
        "rotationLimitWest",
        "backtracking"
      ],
      "additionalProperties": false
    },
    "GtiMountingTimeSeriesTracker": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "TIME_SERIES_TRACKER"
          ]
        }
      },
      "required": [
        "type"
      ],
      "additionalProperties": false
    },
    "GtiMounting": {
      "oneOf": [
        {
          "$ref": "#/$defs/GtiMountingFixedOneAngle"
        },
        {
          "$ref": "#/$defs/GtiMountingOneAxisHorizontalTrackerNS"
        },
        {
          "$ref": "#/$defs/GtiMountingOneAxisInclinedTrackerNS"
        },
        {
          "$ref": "#/$defs/GtiMountingOneAxisVerticalTracker"
        },
        {
          "$ref": "#/$defs/GtiMountingTwoAxisAstronomicalTracker"
        },
        {
          "$ref": "#/$defs/GtiMountingTimeSeriesTracker"
        }
      ]
    },
    "GtiSystemLayout": {
      "type": "object",
      "properties": {
        "azimuth": {
          "type": "number",
          "minimum": 0,
          "maximum": 360
        },
        "relativeSpacing": {
          "type": "number",
          "minimum": 0.1
        },
        "mounting": {
          "$ref": "#/$defs/GtiMounting"
        }
      },
      "required": [
        "mounting"
      ],
      "additionalProperties": false
    },
    "DegreesHorizonAzimuth": {
      "type": "number",
      "minimum": 0,
      "maximum": 360
    },
    "DegreesHorizonHeight": {
      "type": "number",
      "minimum": 0,
      "maximum": 90
    },
    "Horizon": {
      "type": "object",
      "properties": {
        "azimuth": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/DegreesHorizonAzimuth"
          }
        },
        "height": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/DegreesHorizonHeight"
          }
        }
      },
      "required": [
        "azimuth",
        "height"
      ]
    },
    "NormalizedPercentage": {
      "type": "number",
      "minimum": 0,
      "maximum": 1
    },
    "MonthlyValuesNormalizedPercentage": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/NormalizedPercentage"
      },
      "minItems": 12,
      "maxItems": 12
    },
    "GtiEnvironment": {
      "type": "object",
      "properties": {
        "terrainAlbedo": {
          "oneOf": [
            {
              "$ref": "#/$defs/NormalizedPercentage"
            },
            {
              "$ref": "#/$defs/MonthlyValuesNormalizedPercentage"
            }
          ]
        },
        "horizon": {
          "$ref": "solargis_common_types.schema.json#/$defs/Horizon"
        }
      }
    },
    "GtiSystem": {
      "type": "object",
      "properties": {
        "layout": {
          "$ref": "#/$defs/GtiSystemLayout"
        },
        "environment": {
          "$ref": "#/$defs/GtiEnvironment"
        }
      }
    }
  }
}
