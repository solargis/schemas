{
  "$id": "https://raw.githubusercontent.com/solargis/schemas/v1.1.5/solargis_pv_configuration_v1.schema.json",
  "$schema": "https://json-schema.org/draft-07/schema",
  "description": "Following type definitions Solargis uses for the simulation of PV output.",
  "$defs": {
    "PvConfigurationV1": {
      "description": "PV configuration object supported by the first version PV simulation engine.",
      "type": "object",
      "additionalProperties": false,
      "required": [
        "simulationEngine"
      ],
      "properties": {
        "simulationEngine": {
          "description": "PV simulation engine.",
          "type": "string",
          "enum": [
            "v1.0"
          ]
        }
      },
      "oneOf": [
        {
          "required": [
            "segments"
          ],
          "properties": {
            "segments": {
              "description": "One or multiple homogeneous PV system segments.",
              "type": "array",
              "minItems": 1,
              "maxItems": 10,
              "items": {
                "$ref": "#/$defs/PvSystemSegment"
              }
            }
          }
        },
        {
          "description": "PV system with a single homogeneous array.",
          "allOf": [
            {
              "$ref": "#/$defs/PvSystemSegment"
            }
          ]
        }
      ]
    },
    "PvSystemSegment": {
      "description": "PV system segment represents a homogeneous PV array with the same installation type. Azimuth and tilt of PV modules are homogeneous or the same tracking system is used in the array.",
      "type": "object",
      "additionalProperties": false,
      "required": [
        "installationType",
        "installedPower",
        "module",
        "gtiConfiguration"
      ],
      "properties": {
        "installationType": {
          "description": "Thermal losses are increased for building and roof PV systems.",
          "type": "string",
          "enum": [
            "FREE_STANDING",
            "ROOF_MOUNTED",
            "BUILDING_INTEGRATED"
          ]
        },
        "GCR": {
          "description": "Ground Cover Ratio [%] (=1/relativeSpacing*100), convenience helper to calculate the relativeSpacing. If the gtiConfiguration.layout.relativeSpacing if present, it will override the GCR value. The relativeSpacing = 100/GCR.",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 40
        },
        "startupDate": {
          "description": "Startup date of a PV system (unpacking of PV modules). This parameter is used for calculation of PV module degradation by aging.",
          "type": "string",
          "format": "date"
        },
        "availability": {
          "description": "Percentage of time during the reporting period when the PV power plant was allowed by the external grid to export its full available power output without curtailment or grid-imposed limitations. A value of 100% indicates no external restrictions on power export. This does not include internal unavailability due to plant faults or maintenance.",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 100
        },
        "installedPower": {
          "description": "Total PV system rating (nameplate capacity) is the summation of all panel ratings measured in STC, in kilowatt-peaks (kWp)",
          "type": "number",
          "minimum": 0
        },
        "topologyType": {
          "description": "This parameter estimates a loss of PV system output when modules are self-shaded. The effect depends on wiring interconnections within a module. Shading influence ranges from 0% (no influence) to 100% (full influence) and it's mapped to categories: PROPORTIONAL = 20%, UNPROPORTIONAL_1 = 40%, UNPROPORTIONAL_2 = 60%, UNPROPORTIONAL_3 = 80%. When parameter is missing, the self-shading influence is estimated to 5 %.",
          "$comment": "Defaults: UNPROPORTIONAL_1 for CSI, PROPORTIONAL for all other module technologies",
          "type": "string",
          "enum": [
            "PROPORTIONAL",
            "UNPROPORTIONAL_1",
            "UNPROPORTIONAL_2",
            "UNPROPORTIONAL_3"
          ]
        },
        "degradation": {
          "description": "Annual percentage degradation. The default is 0.5% perf. degradation every year.",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 0.5
        },
        "degradationFirstYear": {
          "description": "Annual percentage degradation specifically for the first year of operation.",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 0.8
        },
        "module": {
          "$ref": "#/$defs/Module"
        },
        "selfShading": {
          "description": "The parameter affects FixedOneAngle geometry, then OneAxisHorizontalNS and OneAxisInclined type of trackers with backTracking=false. When backTracking=true, the parameter does not make sense as self-shading is avoided. The parameter is used to determine the impact of self (inter-row) shading on PV power production. When set to true, the effect of self-shading is taken into account in calculation, otherwise the structure is assumed without neighbors (best possible). Direct shadow is considered, the effect of diffuse shading is not considered in this version.",
          "type": "boolean",
          "default": false
        },
        "terrain": {
          "description": "Properties of the terrain - used only for the calculation of self-shading effect of the FixedOneAngle PV system.",
          "$ref": "#/$defs/Terrain"
        },
        "inverter": {
          "$ref": "#/$defs/Inverter"
        },
        "dcLosses": {
          "$ref": "#/$defs/DcLosses"
        },
        "acLosses": {
          "$ref": "#/$defs/AcLosses"
        },
        "gtiConfiguration": {
          "$ref": "solargis_gti_configuration_v2.schema.json#/$defs/GtiSystem"
        }
      }
    },
    "Module": {
      "description": "PV module",
      "type": "object",
      "additionalProperties": false,
      "required": [
        "technology"
      ],
      "properties": {
        "technology": {
          "description": "Codes for materials used in PV modules. Use 'CSI' for crystalline silicon, 'ASI' for amorphous silicon, 'CDTE' for cadmium telluride, 'CIS' for copper indium selenide.",
          "type": "string",
          "enum": [
            "CSI",
            "ASI",
            "CDTE",
            "CIS"
          ]
        },
        "NOCT": {
          "description": "Normal operating cell temperature. Temperature in degrees Celsius of a free standing PV module exposed to irradiance of 800 W/m2 and ambient air temperature of 20°C and wind speed of 1 m/s. The value is given by manufacturer and only for ventilated free standing PV system.",
          "$comment": "Defaults according to moduleTechnology value: CSI=46°C, ASI=44°C, CDTE=48°C, CIS=47°C.",
          "type": "number"
        },
        "temperatureCoefficientPmax": {
          "description": "Negative percentage value representing the change in PV panel output power for temperatures other than 25°C (decrease of output power with raising temperature). This property is given by the manufacturer at STC.",
          "$comment": "Defaults according to moduleTechnology: CSI=-0.438%/°C, ASI=-0.18%/°C, CDTE=-0.297%/°C, CIS=-0.36%/°C.",
          "type": "number",
          "exclusiveMaximum": 0
        }
      }
    },
    "Terrain": {
      "description": "Properties of the terrain.",
      "type": "object",
      "additionalProperties": false,
      "required": [
        "azimuth",
        "slope"
      ],
      "properties": {
        "azimuth": {
          "$ref": "solargis_common_types.schema.json#/$defs/TrueNorthBasedAzimuth",
          "default": 180
        },
        "slope": {
          "$ref": "solargis_common_types.schema.json#/$defs/Tilt",
          "default": 0
        }
      }
    },
    "Inverter": {
      "description": "Properties of the PV inverter.",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "inverterEfficiency": {
          "$ref": "#/$defs/InverterEfficiency"
        },
        "inverterLimitationACPower": {
          "description": "Maximum AC power in kW delivered by the inverter without the limitation (clipping) of AC output. Clipping refers to the situation where the AC power output of an inverter is limited due to the peak rating of the inverter (the parameter value in kw), even though additional power may still be available from the solar modules. If you have power factor (PF) and AC limit in kVA available, use this formula: PF * AC_limit_kVA = kW, which is the value of this parameter.",
          "type": "number",
          "minimum": 0
        },
        "startPower": {
          "description": "Minimum power in kW when inverter starts to work.",
          "type": "number",
          "minimum": 0
        }
      }
    },
    "InverterEfficiency": {
      "description": "Efficiency of the PV inverter.",
      "type": "object",
      "additionalProperties": false,
      "oneOf": [
        {
          "required": [
            "constant"
          ]
        },
        {
          "required": [
            "curve"
          ]
        }
      ],
      "properties": {
        "constant": {
          "description": "Value of inverter efficiency known as Euro or CEC (California Energy Commission) efficiency. This value is a calculated weighted efficiency given by manufacturer. It gives a simplified picture of the non-linear inverter performance. Valid range of this value is practically 70%-100%.",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 97.5
        },
        "curve": {
          "$ref": "#/$defs/InverterEfficiencyCurve",
          "examples": [
            {
              "inputPowerKilowatts": [
                0.5,
                1,
                1.5,
                2,
                2.5,
                3.0
              ],
              "efficiencyPercentage": [
                96.2,
                98,
                97,
                97,
                96,
                96.5
              ]
            }
          ]
        }
      }
    },
    "InverterEfficiencyCurve": {
      "description": "Non-linear efficiency of the inverter can be described as a simplified curve defined as list of data points.",
      "type": "object",
      "required": [
        "inputPowerKilowatts",
        "efficiencyPercentage"
      ],
      "additionalProperties": false,
      "properties": {
        "inputPowerKilowatts": {
          "description": "Input power in kilowatts (kW).",
          "type": "array",
          "items": {
            "type": [
              "number"
            ],
            "minimum": 0
          }
        },
        "efficiencyPercentage": {
          "description": "Inverter's efficiency (%).",
          "type": "array",
          "items": {
            "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive"
          }
        }
      }
    },
    "DcLosses": {
      "description": "PV power losses on the DC side. We allow exactly one way - either specific or overall losses.",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "overall": {
          "description": "Overall % estimate of all specific DC losses (mismatch, cabling, soiling).",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 5.4
        },
        "specific": {
          "$ref": "#/$defs/SpecificDcLosses"
        }
      },
      "oneOf": [
        {
          "required": [
            "overall"
          ]
        },
        {
          "required": [
            "specific"
          ]
        }
      ]
    },
    "SpecificDcLosses": {
      "description": "Specific PV power losses on the DC side.",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "mismatch": {
          "description": "% estimate of the mismatch losses.",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 1.0
        },
        "cabling": {
          "description": "% estimate of the cabling losses.",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 2.0
        },
        "soiling": {
          "description": "% estimate of the soiling losses.",
          "$ref": "#/$defs/SoilingLosses"
        }
      }
    },
    "SoilingLosses": {
      "description": "PV power losses due to soiling.",
      "type": "object",
      "additionalProperties": false,
      "oneOf": [
        {
          "required": [
            "overall"
          ]
        },
        {
          "required": [
            "monthly"
          ]
        }
      ],
      "properties": {
        "overall": {
          "description": "Overall % estimate of soiling losses.",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 2.5
        },
        "monthly": {
          "description": "Distribution of the soiling losses into 12 average calendar months.",
          "type": "array",
          "minItems": 12,
          "maxItems": 12,
          "items": {
            "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive"
          }
        }
      }
    },
    "AcLosses": {
      "description": "PV power losses on the AC side. We allow exactly one way - either specific or overall losses.",
      "type": "object",
      "additionalProperties": false,
      "oneOf": [
        {
          "required": [
            "overall"
          ]
        },
        {
          "required": [
            "specific"
          ]
        }
      ],
      "properties": {
        "overall": {
          "description": "Overall % estimate of all specific AC losses (transformer, cabling).",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 1.5
        },
        "specific": {
          "$ref": "#/$defs/SpecificAcLosses"
        }
      }
    },
    "SpecificAcLosses": {
      "description": "Specific PV power losses on the AC side.",
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "transformer": {
          "description": "% estimate of the transformer losses.",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 1.0
        },
        "cabling": {
          "description": "% estimate of the cabling losses.",
          "$ref": "solargis_common_types.schema.json#/$defs/PercentagePositive",
          "default": 0.5
        }
      }
    }
  }
}
